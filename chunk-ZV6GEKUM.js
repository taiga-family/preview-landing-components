import{g as T,h as x,i as Oe,j as te,l as Me,n as W,p as b,q as p,r as xe}from"./chunk-JWNVKOIN.js";var I=function(e){for(var n=0;;n++)if(e=e.previousSibling,!e)return n};var qe=function(e,n,t,o){return t&&(ke(e,n,t,o,-1)||ke(e,n,t,o,1))},ct=/^(img|br|input|textarea|hr)$/i;function ke(e,n,t,o,i){for(;;){if(e==t&&n==o)return!0;if(n==(i<0?0:X(e))){let s=e.parentNode;if(!s||s.nodeType!=1||pe(e)||ct.test(e.nodeName)||e.contentEditable=="false")return!1;n=I(e)+(i<0?0:1),e=s}else if(e.nodeType==1){if(e=e.childNodes[n+(i<0?-1:0)],e.contentEditable=="false")return!1;n=i<0?X(e):0}else return!1}}function X(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function dt(e,n,t){for(let o=n==0,i=n==X(e);o||i;){if(e==t)return!0;let s=I(e);if(e=e.parentNode,!e)return!1;o=o&&s==0,i=i&&s==X(e)}}function pe(e){let n;for(let t=e;t&&!(n=t.pmViewDesc);t=t.parentNode);return n&&n.node&&n.node.isBlock&&(n.dom==e||n.contentDOM==e)}var He=function(e){return e.focusNode&&qe(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function We(e,n){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=e,t.key=t.code=n,t}var M=typeof navigator<"u"?navigator:null,Te=typeof document<"u"?document:null,P=M&&M.userAgent||"",oe=/Edge\/(\d+)/.exec(P),_e=/MSIE \d/.exec(P),ie=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(P),H=!!(_e||ie||oe),me=_e?document.documentMode:ie?+ie[1]:oe?+oe[1]:0,v=!H&&/gecko\/(\d+)/i.test(P);v&&+(/Firefox\/(\d+)/.exec(P)||[0,0])[1];var se=!H&&/Chrome\/(\d+)/.exec(P),F=!!se,ft=se?+se[1]:0,z=!H&&!!M&&/Apple Computer/.test(M.vendor),ge=z&&(/Mobile\/\w+/.test(P)||!!M&&M.maxTouchPoints>2),D=ge||(M?/Mac/.test(M.platform):!1),ht=M?/Win/.test(M.platform):!1,G=/Android \d/.test(P),ye=!!Te&&"webkitFontSmoothing"in Te.documentElement.style,ut=ye?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;var je=function(e){e&&(this.nodeName=e)};je.prototype=Object.create(null);var Zt=[new je];function pt(e,n=null){let t=e.domSelectionRange(),o=e.state.doc;if(!t.focusNode)return null;let i=e.docView.nearestDesc(t.focusNode),s=i&&i.size==0,r=e.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(r<0)return null;let l=o.resolve(r),a,d;if(He(t)){for(a=l;i&&!i.node;)i=i.parent;let c=i.node;if(i&&c.isAtom&&p.isSelectable(c)&&i.parent&&!(c.isInline&&dt(t.focusNode,t.focusOffset,i.dom))){let f=i.posBefore;d=new p(r==f?l:o.resolve(f))}}else{let c=e.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(c<0)return null;a=o.resolve(c)}if(!d){let c=n=="pointer"||e.state.selection.head<l.pos&&!s?1:-1;d=Ge(e,a,l,c)}return d}function Ue(e){return e.editable?e.hasFocus():bt(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function be(e,n=!1){let t=e.state.selection;if(yt(e,t),!!Ue(e)){if(!n&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&F){let o=e.domSelectionRange(),i=e.domObserver.currentSelection;if(o.anchorNode&&i.anchorNode&&qe(o.anchorNode,o.anchorOffset,i.anchorNode,i.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper)gt(e);else{let{anchor:o,head:i}=t,s,r;Ae&&!(t instanceof b)&&(t.$from.parent.inlineContent||(s=Ee(e,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(r=Ee(e,t.to))),e.docView.setSelection(o,i,e.root,n),Ae&&(s&&Pe(s),r&&Pe(r)),t.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&mt(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}var Ae=z||F&&ft<63;function Ee(e,n){let{node:t,offset:o}=e.docView.domFromPos(n,0),i=o<t.childNodes.length?t.childNodes[o]:null,s=o?t.childNodes[o-1]:null;if(z&&i&&i.contentEditable=="false")return ne(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return ne(i);if(s)return ne(s)}}function ne(e){return e.contentEditable="true",z&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function Pe(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function mt(e){let n=e.dom.ownerDocument;n.removeEventListener("selectionchange",e.input.hideSelectionGuard);let t=e.domSelectionRange(),o=t.anchorNode,i=t.anchorOffset;n.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(t.anchorNode!=o||t.anchorOffset!=i)&&(n.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!Ue(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}function gt(e){let n=e.domSelection(),t=document.createRange(),o=e.cursorWrapper.dom,i=o.nodeName=="IMG";i?t.setEnd(o.parentNode,I(o)+1):t.setEnd(o,0),t.collapse(!1),n.removeAllRanges(),n.addRange(t),!i&&!e.state.selection.visible&&H&&me<=11&&(o.disabled=!0,o.disabled=!1)}function yt(e,n){if(n instanceof p){let t=e.docView.descAt(n.from);t!=e.lastSelectedViewDesc&&(Ve(e),t&&t.selectNode(),e.lastSelectedViewDesc=t)}else Ve(e)}function Ve(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function Ge(e,n,t,o){return e.someProp("createSelectionBetween",i=>i(e,n,t))||b.between(n,t,o)}function bt(e){let n=e.domSelectionRange();if(!n.anchorNode)return!1;try{return e.dom.contains(n.anchorNode.nodeType==3?n.anchorNode.parentNode:n.anchorNode)&&(e.editable||e.dom.contains(n.focusNode.nodeType==3?n.focusNode.parentNode:n.focusNode))}catch{return!1}}function re(e,n){let{$anchor:t,$head:o}=e.selection,i=n>0?t.max(o):t.min(o),s=i.parent.inlineContent?i.depth?e.doc.resolve(n>0?i.after():i.before()):null:i;return s&&W.findFrom(s,n)}function A(e,n){return e.dispatch(e.state.tr.setSelection(n).scrollIntoView()),!0}function Re(e,n,t){let o=e.state.selection;if(o instanceof b)if(t.indexOf("s")>-1){let{$head:i}=o,s=i.textOffset?null:n<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let r=e.state.doc.resolve(i.pos+s.nodeSize*(n<0?-1:1));return A(e,new b(o.$anchor,r))}else if(o.empty){if(e.endOfTextblock(n>0?"forward":"backward")){let i=re(e.state,n);return i&&i instanceof p?A(e,i):!1}else if(!(D&&t.indexOf("m")>-1)){let i=o.$head,s=i.textOffset?null:n<0?i.nodeBefore:i.nodeAfter,r;if(!s||s.isText)return!1;let l=n<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(r=e.docView.descAt(l))&&!r.contentDOM?p.isSelectable(s)?A(e,new p(n<0?e.state.doc.resolve(i.pos-s.nodeSize):i)):ye?A(e,new b(e.state.doc.resolve(n<0?l:l+s.nodeSize))):!1:!1}}else return!1;else{if(o instanceof p&&o.node.isInline)return A(e,new b(n>0?o.$to:o.$from));{let i=re(e.state,n);return i?A(e,i):!1}}}function J(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function _(e,n){let t=e.pmViewDesc;return t&&t.size==0&&(n<0||e.nextSibling||e.nodeName!="BR")}function L(e,n){return n<0?Dt(e):St(e)}function Dt(e){let n=e.domSelectionRange(),t=n.focusNode,o=n.focusOffset;if(!t)return;let i,s,r=!1;for(v&&t.nodeType==1&&o<J(t)&&_(t.childNodes[o],-1)&&(r=!0);;)if(o>0){if(t.nodeType!=1)break;{let l=t.childNodes[o-1];if(_(l,-1))i=t,s=--o;else if(l.nodeType==3)t=l,o=t.nodeValue.length;else break}}else{if(Ye(t))break;{let l=t.previousSibling;for(;l&&_(l,-1);)i=t.parentNode,s=I(l),l=l.previousSibling;if(l)t=l,o=J(t);else{if(t=t.parentNode,t==e.dom)break;o=0}}}r?le(e,t,o):i&&le(e,i,s)}function St(e){let n=e.domSelectionRange(),t=n.focusNode,o=n.focusOffset;if(!t)return;let i=J(t),s,r;for(;;)if(o<i){if(t.nodeType!=1)break;let l=t.childNodes[o];if(_(l,1))s=t,r=++o;else break}else{if(Ye(t))break;{let l=t.nextSibling;for(;l&&_(l,1);)s=l.parentNode,r=I(l)+1,l=l.nextSibling;if(l)t=l,o=0,i=J(t);else{if(t=t.parentNode,t==e.dom)break;o=i=0}}}s&&le(e,s,r)}function Ye(e){let n=e.pmViewDesc;return n&&n.node&&n.node.isBlock}function Nt(e,n){for(;e&&n==e.childNodes.length&&!pe(e);)n=I(e)+1,e=e.parentNode;for(;e&&n<e.childNodes.length;){let t=e.childNodes[n];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;e=t,n=0}}function Ct(e,n){for(;e&&!n&&!pe(e);)n=I(e),e=e.parentNode;for(;e&&n;){let t=e.childNodes[n-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;e=t,n=e.childNodes.length}}function le(e,n,t){if(n.nodeType!=3){let s,r;(r=Nt(n,t))?(n=r,t=0):(s=Ct(n,t))&&(n=s,t=s.nodeValue.length)}let o=e.domSelection();if(He(o)){let s=document.createRange();s.setEnd(n,t),s.setStart(n,t),o.removeAllRanges(),o.addRange(s)}else o.extend&&o.extend(n,t);e.domObserver.setCurSelection();let{state:i}=e;setTimeout(()=>{e.state==i&&be(e)},50)}function Be(e,n){let t=e.state.doc.resolve(n);if(!(F||ht)&&t.parent.inlineContent){let i=e.coordsAtPos(n);if(n>t.start()){let s=e.coordsAtPos(n-1),r=(s.top+s.bottom)/2;if(r>i.top&&r<i.bottom&&Math.abs(s.left-i.left)>1)return s.left<i.left?"ltr":"rtl"}if(n<t.end()){let s=e.coordsAtPos(n+1),r=(s.top+s.bottom)/2;if(r>i.top&&r<i.bottom&&Math.abs(s.left-i.left)>1)return s.left>i.left?"ltr":"rtl"}}return getComputedStyle(e.dom).direction=="rtl"?"rtl":"ltr"}function Ie(e,n,t){let o=e.state.selection;if(o instanceof b&&!o.empty||t.indexOf("s")>-1||D&&t.indexOf("m")>-1)return!1;let{$from:i,$to:s}=o;if(!i.parent.inlineContent||e.endOfTextblock(n<0?"up":"down")){let r=re(e.state,n);if(r&&r instanceof p)return A(e,r)}if(!i.parent.inlineContent){let r=n<0?i:s,l=o instanceof xe?W.near(r,n):W.findFrom(r,n);return l?A(e,l):!1}return!1}function Fe(e,n){if(!(e.state.selection instanceof b))return!0;let{$head:t,$anchor:o,empty:i}=e.state.selection;if(!t.sameParent(o))return!0;if(!i)return!1;if(e.endOfTextblock(n>0?"forward":"backward"))return!0;let s=!t.textOffset&&(n<0?t.nodeBefore:t.nodeAfter);if(s&&!s.isText){let r=e.state.tr;return n<0?r.delete(t.pos-s.nodeSize,t.pos):r.delete(t.pos,t.pos+s.nodeSize),e.dispatch(r),!0}return!1}function ze(e,n,t){e.domObserver.stop(),n.contentEditable=t,e.domObserver.start()}function Ot(e){if(!z||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:n,focusOffset:t}=e.domSelectionRange();if(n&&n.nodeType==1&&t==0&&n.firstChild&&n.firstChild.contentEditable=="false"){let o=n.firstChild;ze(e,o,"true"),setTimeout(()=>ze(e,o,"false"),20)}return!1}function Mt(e){let n="";return e.ctrlKey&&(n+="c"),e.metaKey&&(n+="m"),e.altKey&&(n+="a"),e.shiftKey&&(n+="s"),n}function xt(e,n){let t=n.keyCode,o=Mt(n);if(t==8||D&&t==72&&o=="c")return Fe(e,-1)||L(e,-1);if(t==46&&!n.shiftKey||D&&t==68&&o=="c")return Fe(e,1)||L(e,1);if(t==13||t==27)return!0;if(t==37||D&&t==66&&o=="c"){let i=t==37?Be(e,e.state.selection.from)=="ltr"?-1:1:-1;return Re(e,i,o)||L(e,i)}else if(t==39||D&&t==70&&o=="c"){let i=t==39?Be(e,e.state.selection.from)=="ltr"?1:-1:1;return Re(e,i,o)||L(e,i)}else{if(t==38||D&&t==80&&o=="c")return Ie(e,-1,o)||L(e,-1);if(t==40||D&&t==78&&o=="c")return Ot(e)||Ie(e,1,o)||L(e,1);if(o==(D?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Xe(e,n){e.someProp("transformCopied",u=>{n=u(n,e)});let t=[],{content:o,openStart:i,openEnd:s}=n;for(;i>1&&s>1&&o.childCount==1&&o.firstChild.childCount==1;){i--,s--;let u=o.firstChild;t.push(u.type.name,u.attrs!=u.type.defaultAttrs?u.attrs:null),o=u.content}let r=e.someProp("clipboardSerializer")||te.fromSchema(e.state.schema),l=et(),a=l.createElement("div");a.appendChild(r.serializeFragment(o,{document:l}));let d=a.firstChild,c,f=0;for(;d&&d.nodeType==1&&(c=ve[d.nodeName.toLowerCase()]);){for(let u=c.length-1;u>=0;u--){let m=l.createElement(c[u]);for(;a.firstChild;)m.appendChild(a.firstChild);a.appendChild(m),f++}d=a.firstChild}d&&d.nodeType==1&&d.setAttribute("data-pm-slice",`${i} ${s}${f?` -${f}`:""} ${JSON.stringify(t)}`);let h=e.someProp("clipboardTextSerializer",u=>u(n,e))||n.content.textBetween(0,n.content.size,`

`);return{dom:a,text:h}}function Je(e,n,t,o,i){let s=i.parent.type.spec.code,r,l;if(!t&&!n)return null;let a=n&&(o||s||!t);if(a){if(e.someProp("transformPastedText",h=>{n=h(n,s||o,e)}),s)return n?new x(T.from(e.state.schema.text(n.replace(/\r\n?/g,`
`))),0,0):x.empty;let f=e.someProp("clipboardTextParser",h=>h(n,i,o,e));if(f)l=f;else{let h=i.marks(),{schema:u}=e.state,m=te.fromSchema(u);r=document.createElement("div"),n.split(/(?:\r\n?|\n)+/).forEach(k=>{let S=r.appendChild(document.createElement("p"));k&&S.appendChild(m.serializeNode(u.text(k,h)))})}}else e.someProp("transformPastedHTML",f=>{t=f(t,e)}),r=At(t),ye&&Et(r);let d=r&&r.querySelector("[data-pm-slice]"),c=d&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(d.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let f=+c[3];f>0;f--){let h=r.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;r=h}if(l||(l=(e.someProp("clipboardParser")||e.someProp("domParser")||Oe.fromSchema(e.state.schema)).parseSlice(r,{preserveWhitespace:!!(a||c),context:i,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!kt.test(h.parentNode.nodeName)?{ignore:!0}:null}})),c)l=Pt(Le(l,+c[1],+c[2]),c[4]);else if(l=x.maxOpen(Tt(l.content,i),!0),l.openStart||l.openEnd){let f=0,h=0;for(let u=l.content.firstChild;f<l.openStart&&!u.type.spec.isolating;f++,u=u.firstChild);for(let u=l.content.lastChild;h<l.openEnd&&!u.type.spec.isolating;h++,u=u.lastChild);l=Le(l,f,h)}return e.someProp("transformPasted",f=>{l=f(l,e)}),l}var kt=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Tt(e,n){if(e.childCount<2)return e;for(let t=n.depth;t>=0;t--){let i=n.node(t).contentMatchAt(n.index(t)),s,r=[];if(e.forEach(l=>{if(!r)return;let a=i.findWrapping(l.type),d;if(!a)return r=null;if(d=r.length&&s.length&&Qe(a,s,l,r[r.length-1],0))r[r.length-1]=d;else{r.length&&(r[r.length-1]=we(r[r.length-1],s.length));let c=Ze(l,a);r.push(c),i=i.matchType(c.type),s=a}}),r)return T.from(r)}return e}function Ze(e,n,t=0){for(let o=n.length-1;o>=t;o--)e=n[o].create(null,T.from(e));return e}function Qe(e,n,t,o,i){if(i<e.length&&i<n.length&&e[i]==n[i]){let s=Qe(e,n,t,o.lastChild,i+1);if(s)return o.copy(o.content.replaceChild(o.childCount-1,s));if(o.contentMatchAt(o.childCount).matchType(i==e.length-1?t.type:e[i+1]))return o.copy(o.content.append(T.from(Ze(t,e,i+1))))}}function we(e,n){if(n==0)return e;let t=e.content.replaceChild(e.childCount-1,we(e.lastChild,n-1)),o=e.contentMatchAt(e.childCount).fillBefore(T.empty,!0);return e.copy(t.append(o))}function ae(e,n,t,o,i,s){let r=n<0?e.firstChild:e.lastChild,l=r.content;return e.childCount>1&&(s=0),i<o-1&&(l=ae(l,n,t,o,i+1,s)),i>=t&&(l=n<0?r.contentMatchAt(0).fillBefore(l,s<=i).append(l):l.append(r.contentMatchAt(r.childCount).fillBefore(T.empty,!0))),e.replaceChild(n<0?0:e.childCount-1,r.copy(l))}function Le(e,n,t){return n<e.openStart&&(e=new x(ae(e.content,-1,n,e.openStart,0,e.openEnd),n,e.openEnd)),t<e.openEnd&&(e=new x(ae(e.content,1,t,e.openEnd,0,0),e.openStart,t)),e}var ve={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},$e=null;function et(){return $e||($e=document.implementation.createHTMLDocument("title"))}function At(e){let n=/^(\s*<meta [^>]*>)*/.exec(e);n&&(e=e.slice(n[0].length));let t=et().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(e),i;if((i=o&&ve[o[1].toLowerCase()])&&(e=i.map(s=>"<"+s+">").join("")+e+i.map(s=>"</"+s+">").reverse().join("")),t.innerHTML=e,i)for(let s=0;s<i.length;s++)t=t.querySelector(i[s])||t;return t}function Et(e){let n=e.querySelectorAll(F?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<n.length;t++){let o=n[t];o.childNodes.length==1&&o.textContent=="\xA0"&&o.parentNode&&o.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),o)}}function Pt(e,n){if(!e.size)return e;let t=e.content.firstChild.type.schema,o;try{o=JSON.parse(n)}catch{return e}let{content:i,openStart:s,openEnd:r}=e;for(let l=o.length-2;l>=0;l-=2){let a=t.nodes[o[l]];if(!a||a.hasRequiredAttrs())break;i=T.from(a.create(o[l+1],i)),s++,r++}return new x(i,s,r)}var O={},y={};function E(e,n){e.input.lastSelectionOrigin=n,e.input.lastSelectionTime=Date.now()}y.keydown=(e,n)=>{let t=n;if(e.input.shiftKey=t.keyCode==16||t.shiftKey,!nt(e,t)&&(e.input.lastKeyCode=t.keyCode,e.input.lastKeyCodeTime=Date.now(),!(G&&F&&t.keyCode==13)))if(t.keyCode!=229&&e.domObserver.forceFlush(),ge&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let o=Date.now();e.input.lastIOSEnter=o,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==o&&(e.someProp("handleKeyDown",i=>i(e,We(13,"Enter"))),e.input.lastIOSEnter=0)},200)}else e.someProp("handleKeyDown",o=>o(e,t))||xt(e,t)?t.preventDefault():E(e,"key")};y.keyup=(e,n)=>{n.keyCode==16&&(e.input.shiftKey=!1)};y.keypress=(e,n)=>{let t=n;if(nt(e,t)||!t.charCode||t.ctrlKey&&!t.altKey||D&&t.metaKey)return;if(e.someProp("handleKeyPress",i=>i(e,t))){t.preventDefault();return}let o=e.state.selection;if(!(o instanceof b)||!o.$from.sameParent(o.$to)){let i=String.fromCharCode(t.charCode);!/[\r\n]/.test(i)&&!e.someProp("handleTextInput",s=>s(e,o.$from.pos,o.$to.pos,i))&&e.dispatch(e.state.tr.insertText(i).scrollIntoView()),t.preventDefault()}};function ee(e){return{left:e.clientX,top:e.clientY}}function Vt(e,n){let t=n.x-e.clientX,o=n.y-e.clientY;return t*t+o*o<100}function De(e,n,t,o,i){if(o==-1)return!1;let s=e.state.doc.resolve(o);for(let r=s.depth+1;r>0;r--)if(e.someProp(n,l=>r>s.depth?l(e,t,s.nodeAfter,s.before(r),i,!0):l(e,t,s.node(r),s.before(r),i,!1)))return!0;return!1}function K(e,n,t){e.focused||e.focus();let o=e.state.tr.setSelection(n);t=="pointer"&&o.setMeta("pointer",!0),e.dispatch(o)}function Rt(e,n){if(n==-1)return!1;let t=e.state.doc.resolve(n),o=t.nodeAfter;return o&&o.isAtom&&p.isSelectable(o)?(K(e,new p(t),"pointer"),!0):!1}function Bt(e,n){if(n==-1)return!1;let t=e.state.selection,o,i;t instanceof p&&(o=t.node);let s=e.state.doc.resolve(n);for(let r=s.depth+1;r>0;r--){let l=r>s.depth?s.nodeAfter:s.node(r);if(p.isSelectable(l)){o&&t.$from.depth>0&&r>=t.$from.depth&&s.before(t.$from.depth+1)==t.$from.pos?i=s.before(t.$from.depth):i=s.before(r);break}}return i!=null?(K(e,p.create(e.state.doc,i),"pointer"),!0):!1}function It(e,n,t,o,i){return De(e,"handleClickOn",n,t,o)||e.someProp("handleClick",s=>s(e,n,o))||(i?Bt(e,t):Rt(e,t))}function Ft(e,n,t,o){return De(e,"handleDoubleClickOn",n,t,o)||e.someProp("handleDoubleClick",i=>i(e,n,o))}function zt(e,n,t,o){return De(e,"handleTripleClickOn",n,t,o)||e.someProp("handleTripleClick",i=>i(e,n,o))||Lt(e,t,o)}function Lt(e,n,t){if(t.button!=0)return!1;let o=e.state.doc;if(n==-1)return o.inlineContent?(K(e,b.create(o,0,o.content.size),"pointer"),!0):!1;let i=o.resolve(n);for(let s=i.depth+1;s>0;s--){let r=s>i.depth?i.nodeAfter:i.node(s),l=i.before(s);if(r.inlineContent)K(e,b.create(o,l+1,l+1+r.content.size),"pointer");else if(p.isSelectable(r))K(e,p.create(o,l),"pointer");else continue;return!0}}function Se(e){return Z(e)}var tt=D?"metaKey":"ctrlKey";O.mousedown=(e,n)=>{let t=n;e.input.shiftKey=t.shiftKey;let o=Se(e),i=Date.now(),s="singleClick";i-e.input.lastClick.time<500&&Vt(t,e.input.lastClick)&&!t[tt]&&(e.input.lastClick.type=="singleClick"?s="doubleClick":e.input.lastClick.type=="doubleClick"&&(s="tripleClick")),e.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:s};let r=e.posAtCoords(ee(t));r&&(s=="singleClick"?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new ce(e,r,t,!!o)):(s=="doubleClick"?Ft:zt)(e,r.pos,r.inside,t)?t.preventDefault():E(e,"pointer"))};var ce=class{constructor(n,t,o,i){this.view=n,this.pos=t,this.event=o,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=n.state.doc,this.selectNode=!!o[tt],this.allowDefault=o.shiftKey;let s,r;if(t.inside>-1)s=n.state.doc.nodeAt(t.inside),r=t.inside;else{let c=n.state.doc.resolve(t.pos);s=c.parent,r=c.depth?c.before():0}let l=i?null:o.target,a=l?n.docView.nearestDesc(l,!0):null;this.target=a?a.dom:null;let{selection:d}=n.state;(o.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||d instanceof p&&d.from<=r&&d.to>r)&&(this.mightDrag={node:s,pos:r,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&v&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),n.root.addEventListener("mouseup",this.up=this.up.bind(this)),n.root.addEventListener("mousemove",this.move=this.move.bind(this)),E(n,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>be(this.view)),this.view.input.mouseDown=null}up(n){if(this.done(),!this.view.dom.contains(n.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(ee(n))),this.updateAllowDefault(n),this.allowDefault||!t?E(this.view,"pointer"):It(this.view,t.pos,t.inside,n,this.selectNode)?n.preventDefault():n.button==0&&(this.flushed||z&&this.mightDrag&&!this.mightDrag.node.isAtom||F&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(K(this.view,W.near(this.view.state.doc.resolve(t.pos)),"pointer"),n.preventDefault()):E(this.view,"pointer")}move(n){this.updateAllowDefault(n),E(this.view,"pointer"),n.buttons==0&&this.done()}updateAllowDefault(n){!this.allowDefault&&(Math.abs(this.event.x-n.clientX)>4||Math.abs(this.event.y-n.clientY)>4)&&(this.allowDefault=!0)}};O.touchstart=e=>{e.input.lastTouch=Date.now(),Se(e),E(e,"pointer")};O.touchmove=e=>{e.input.lastTouch=Date.now(),E(e,"pointer")};O.contextmenu=e=>Se(e);function nt(e,n){return e.composing?!0:z&&Math.abs(n.timeStamp-e.input.compositionEndedAt)<500?(e.input.compositionEndedAt=-2e8,!0):!1}var $t=G?5e3:-1;y.compositionstart=y.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:n}=e,t=n.selection.$from;if(n.selection.empty&&(n.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(o=>o.type.spec.inclusive===!1)))e.markCursor=e.state.storedMarks||t.marks(),Z(e,!0),e.markCursor=null;else if(Z(e),v&&n.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let o=e.domSelectionRange();for(let i=o.focusNode,s=o.focusOffset;i&&i.nodeType==1&&s!=0;){let r=s<0?i.lastChild:i.childNodes[s-1];if(!r)break;if(r.nodeType==3){e.domSelection().collapse(r,r.nodeValue.length);break}else i=r,s=-1}}e.input.composing=!0}ot(e,$t)};y.compositionend=(e,n)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=n.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,ot(e,20))};function ot(e,n){clearTimeout(e.input.composingTimeout),n>-1&&(e.input.composingTimeout=setTimeout(()=>Z(e),n))}function Kt(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=qt());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function qt(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}function Z(e,n=!1){if(!(G&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),Kt(e),n||e.docView&&e.docView.dirty){let t=pt(e);return t&&!t.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(t)):e.updateState(e.state),!0}return!1}}function Ht(e,n){if(!e.dom.parentNode)return;let t=e.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(n),t.style.cssText="position: fixed; left: -10000px; top: 10px";let o=getSelection(),i=document.createRange();i.selectNodeContents(n),e.dom.blur(),o.removeAllRanges(),o.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),e.focus()},50)}var j=H&&me<15||ge&&ut<604;O.copy=y.cut=(e,n)=>{let t=n,o=e.state.selection,i=t.type=="cut";if(o.empty)return;let s=j?null:t.clipboardData,r=o.content(),{dom:l,text:a}=Xe(e,r);s?(t.preventDefault(),s.clearData(),s.setData("text/html",l.innerHTML),s.setData("text/plain",a)):Ht(e,l),i&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function Wt(e){return e.openStart==0&&e.openEnd==0&&e.content.childCount==1?e.content.firstChild:null}function _t(e,n){if(!e.dom.parentNode)return;let t=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,o=e.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(o.contentEditable="true"),o.style.cssText="position: fixed; left: -10000px; top: 10px",o.focus();let i=e.input.shiftKey&&e.input.lastKeyCode!=45;setTimeout(()=>{e.focus(),o.parentNode&&o.parentNode.removeChild(o),t?de(e,o.value,null,i,n):de(e,o.textContent,o.innerHTML,i,n)},50)}function de(e,n,t,o,i){let s=Je(e,n,t,o,e.state.selection.$from);if(e.someProp("handlePaste",a=>a(e,i,s||x.empty)))return!0;if(!s)return!1;let r=Wt(s),l=r?e.state.tr.replaceSelectionWith(r,o):e.state.tr.replaceSelection(s);return e.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function it(e){let n=e.getData("text/plain")||e.getData("Text");if(n)return n;let t=e.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}y.paste=(e,n)=>{let t=n;if(e.composing&&!G)return;let o=j?null:t.clipboardData,i=e.input.shiftKey&&e.input.lastKeyCode!=45;o&&de(e,it(o),o.getData("text/html"),i,t)?t.preventDefault():_t(e,t)};var fe=class{constructor(n,t,o){this.slice=n,this.move=t,this.node=o}},st=D?"altKey":"ctrlKey";O.dragstart=(e,n)=>{let t=n,o=e.input.mouseDown;if(o&&o.done(),!t.dataTransfer)return;let i=e.state.selection,s=i.empty?null:e.posAtCoords(ee(t)),r;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof p?i.to-1:i.to))){if(o&&o.mightDrag)r=p.create(e.state.doc,o.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let c=e.docView.nearestDesc(t.target,!0);c&&c.node.type.spec.draggable&&c!=e.docView&&(r=p.create(e.state.doc,c.posBefore))}}let l=(r||e.state.selection).content(),{dom:a,text:d}=Xe(e,l);t.dataTransfer.clearData(),t.dataTransfer.setData(j?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",j||t.dataTransfer.setData("text/plain",d),e.dragging=new fe(l,!t[st],r)};O.dragend=e=>{let n=e.dragging;window.setTimeout(()=>{e.dragging==n&&(e.dragging=null)},50)};y.dragover=y.dragenter=(e,n)=>n.preventDefault();y.drop=(e,n)=>{let t=n,o=e.dragging;if(e.dragging=null,!t.dataTransfer)return;let i=e.posAtCoords(ee(t));if(!i)return;let s=e.state.doc.resolve(i.pos),r=o&&o.slice;r?e.someProp("transformPasted",m=>{r=m(r,e)}):r=Je(e,it(t.dataTransfer),j?null:t.dataTransfer.getData("text/html"),!1,s);let l=!!(o&&!t[st]);if(e.someProp("handleDrop",m=>m(e,t,r||x.empty,l))){t.preventDefault();return}if(!r)return;t.preventDefault();let a=r?Me(e.state.doc,s.pos,r):s.pos;a==null&&(a=s.pos);let d=e.state.tr;if(l){let{node:m}=o;m?m.replace(d):d.deleteSelection()}let c=d.mapping.map(a),f=r.openStart==0&&r.openEnd==0&&r.content.childCount==1,h=d.doc;if(f?d.replaceRangeWith(c,c,r.content.firstChild):d.replaceRange(c,c,r),d.doc.eq(h))return;let u=d.doc.resolve(c);if(f&&p.isSelectable(r.content.firstChild)&&u.nodeAfter&&u.nodeAfter.sameMarkup(r.content.firstChild))d.setSelection(new p(u));else{let m=d.mapping.map(a);d.mapping.maps[d.mapping.maps.length-1].forEach((k,S,N,Y)=>m=Y),d.setSelection(Ge(e,u,d.doc.resolve(m)))}e.focus(),e.dispatch(d.setMeta("uiEvent","drop"))};O.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&be(e)},20))};O.blur=(e,n)=>{let t=n;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),t.relatedTarget&&e.dom.contains(t.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)};O.beforeinput=(e,n)=>{if(F&&G&&n.inputType=="deleteContentBackward"){e.domObserver.flushSoon();let{domChangeCount:o}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=o||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",s=>s(e,We(8,"Backspace")))))return;let{$cursor:i}=e.state.selection;i&&i.pos>0&&e.dispatch(e.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let e in y)O[e]=y[e];function U(e,n){if(e==n)return!0;for(let t in e)if(e[t]!==n[t])return!1;for(let t in n)if(!(t in e))return!1;return!0}var Q=class e{constructor(n,t){this.toDOM=n,this.spec=t||R,this.side=this.spec.side||0}map(n,t,o,i){let{pos:s,deleted:r}=n.mapResult(t.from+i,this.side<0?-1:1);return r?null:new q(s-o,s-o,this)}valid(){return!0}eq(n){return this==n||n instanceof e&&(this.spec.key&&this.spec.key==n.spec.key||this.toDOM==n.toDOM&&U(this.spec,n.spec))}destroy(n){this.spec.destroy&&this.spec.destroy(n)}},V=class e{constructor(n,t){this.attrs=n,this.spec=t||R}map(n,t,o,i){let s=n.map(t.from+i,this.spec.inclusiveStart?-1:1)-o,r=n.map(t.to+i,this.spec.inclusiveEnd?1:-1)-o;return s>=r?null:new q(s,r,this)}valid(n,t){return t.from<t.to}eq(n){return this==n||n instanceof e&&U(this.attrs,n.attrs)&&U(this.spec,n.spec)}static is(n){return n.type instanceof e}destroy(){}},he=class e{constructor(n,t){this.attrs=n,this.spec=t||R}map(n,t,o,i){let s=n.mapResult(t.from+i,1);if(s.deleted)return null;let r=n.mapResult(t.to+i,-1);return r.deleted||r.pos<=s.pos?null:new q(s.pos-o,r.pos-o,this)}valid(n,t){let{index:o,offset:i}=n.content.findIndex(t.from),s;return i==t.from&&!(s=n.child(o)).isText&&i+s.nodeSize==t.to}eq(n){return this==n||n instanceof e&&U(this.attrs,n.attrs)&&U(this.spec,n.spec)}destroy(){}},q=class e{constructor(n,t,o){this.from=n,this.to=t,this.type=o}copy(n,t){return new e(n,t,this.type)}eq(n,t=0){return this.type.eq(n.type)&&this.from+t==n.from&&this.to+t==n.to}map(n,t,o){return this.type.map(n,this,t,o)}static widget(n,t,o){return new e(n,n,new Q(t,o))}static inline(n,t,o,i){return new e(n,t,new V(o,i))}static node(n,t,o,i){return new e(n,t,new he(o,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof V}get widget(){return this.type instanceof Q}},$=[],R={},C=class e{constructor(n,t){this.local=n.length?n:$,this.children=t.length?t:$}static create(n,t){return t.length?w(t,n,0,R):g}find(n,t,o){let i=[];return this.findInner(n??0,t??1e9,i,0,o),i}findInner(n,t,o,i,s){for(let r=0;r<this.local.length;r++){let l=this.local[r];l.from<=t&&l.to>=n&&(!s||s(l.spec))&&o.push(l.copy(l.from+i,l.to+i))}for(let r=0;r<this.children.length;r+=3)if(this.children[r]<t&&this.children[r+1]>n){let l=this.children[r]+1;this.children[r+2].findInner(n-l,t-l,o,i+l,s)}}map(n,t,o){return this==g||n.maps.length==0?this:this.mapInner(n,t,0,0,o||R)}mapInner(n,t,o,i,s){let r;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(n,o,i);a&&a.type.valid(t,a)?(r||(r=[])).push(a):s.onRemove&&s.onRemove(this.local[l].spec)}return this.children.length?jt(this.children,r||[],n,t,o,i,s):r?new e(r.sort(B),$):g}add(n,t){return t.length?this==g?e.create(n,t):this.addInner(n,t,0):this}addInner(n,t,o){let i,s=0;n.forEach((l,a)=>{let d=a+o,c;if(c=lt(t,l,d)){for(i||(i=this.children.slice());s<i.length&&i[s]<a;)s+=3;i[s]==a?i[s+2]=i[s+2].addInner(l,c,d+1):i.splice(s,0,a,a+l.nodeSize,w(c,l,d+1,R)),s+=3}});let r=rt(s?at(t):t,-o);for(let l=0;l<r.length;l++)r[l].type.valid(n,r[l])||r.splice(l--,1);return new e(r.length?this.local.concat(r).sort(B):this.local,i||this.children)}remove(n){return n.length==0||this==g?this:this.removeInner(n,0)}removeInner(n,t){let o=this.children,i=this.local;for(let s=0;s<o.length;s+=3){let r,l=o[s]+t,a=o[s+1]+t;for(let c=0,f;c<n.length;c++)(f=n[c])&&f.from>l&&f.to<a&&(n[c]=null,(r||(r=[])).push(f));if(!r)continue;o==this.children&&(o=this.children.slice());let d=o[s+2].removeInner(r,l+1);d!=g?o[s+2]=d:(o.splice(s,3),s-=3)}if(i.length){for(let s=0,r;s<n.length;s++)if(r=n[s])for(let l=0;l<i.length;l++)i[l].eq(r,t)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return o==this.children&&i==this.local?this:i.length||o.length?new e(i,o):g}forChild(n,t){if(this==g)return this;if(t.isLeaf)return e.empty;let o,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=n){this.children[l]==n&&(o=this.children[l+2]);break}let s=n+1,r=s+t.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<r&&a.to>s&&a.type instanceof V){let d=Math.max(s,a.from)-s,c=Math.min(r,a.to)-s;d<c&&(i||(i=[])).push(a.copy(d,c))}}if(i){let l=new e(i.sort(B),$);return o?new ue([l,o]):l}return o||g}eq(n){if(this==n)return!0;if(!(n instanceof e)||this.local.length!=n.local.length||this.children.length!=n.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(n.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=n.children[t]||this.children[t+1]!=n.children[t+1]||!this.children[t+2].eq(n.children[t+2]))return!1;return!0}locals(n){return Ne(this.localsInner(n))}localsInner(n){if(this==g)return $;if(n.inlineContent||!this.local.some(V.is))return this.local;let t=[];for(let o=0;o<this.local.length;o++)this.local[o].type instanceof V||t.push(this.local[o]);return t}};C.empty=new C([],[]);C.removeOverlap=Ne;var g=C.empty,ue=class e{constructor(n){this.members=n}map(n,t){let o=this.members.map(i=>i.map(n,t,R));return e.from(o)}forChild(n,t){if(t.isLeaf)return C.empty;let o=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(n,t);s!=g&&(s instanceof e?o=o.concat(s.members):o.push(s))}return e.from(o)}eq(n){if(!(n instanceof e)||n.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(n.members[t]))return!1;return!0}locals(n){let t,o=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(n);if(s.length)if(!t)t=s;else{o&&(t=t.slice(),o=!1);for(let r=0;r<s.length;r++)t.push(s[r])}}return t?Ne(o?t:t.sort(B)):$}static from(n){switch(n.length){case 0:return g;case 1:return n[0];default:return new e(n.every(t=>t instanceof C)?n:n.reduce((t,o)=>t.concat(o instanceof C?o:o.members),[]))}}};function jt(e,n,t,o,i,s,r){let l=e.slice();for(let d=0,c=s;d<t.maps.length;d++){let f=0;t.maps[d].forEach((h,u,m,k)=>{let S=k-m-(u-h);for(let N=0;N<l.length;N+=3){let Y=l[N+1];if(Y<0||h>Y+c-f)continue;let Ce=l[N]+c-f;u>=Ce?l[N+1]=h<=Ce?-2:-1:h>=c&&S&&(l[N]+=S,l[N+1]+=S)}f+=S}),c=t.maps[d].map(c,-1)}let a=!1;for(let d=0;d<l.length;d+=3)if(l[d+1]<0){if(l[d+1]==-2){a=!0,l[d+1]=-1;continue}let c=t.map(e[d]+s),f=c-i;if(f<0||f>=o.content.size){a=!0;continue}let h=t.map(e[d+1]+s,-1),u=h-i,{index:m,offset:k}=o.content.findIndex(f),S=o.maybeChild(m);if(S&&k==f&&k+S.nodeSize==u){let N=l[d+2].mapInner(t,S,c+1,e[d]+s+1,r);N!=g?(l[d]=f,l[d+1]=u,l[d+2]=N):(l[d+1]=-2,a=!0)}else a=!0}if(a){let d=Ut(l,e,n,t,i,s,r),c=w(d,o,0,r);n=c.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,h=0;f<c.children.length;f+=3){let u=c.children[f];for(;h<l.length&&l[h]<u;)h+=3;l.splice(h,0,c.children[f],c.children[f+1],c.children[f+2])}}return new C(n.sort(B),l)}function rt(e,n){if(!n||!e.length)return e;let t=[];for(let o=0;o<e.length;o++){let i=e[o];t.push(new q(i.from+n,i.to+n,i.type))}return t}function Ut(e,n,t,o,i,s,r){function l(a,d){for(let c=0;c<a.local.length;c++){let f=a.local[c].map(o,i,d);f?t.push(f):r.onRemove&&r.onRemove(a.local[c].spec)}for(let c=0;c<a.children.length;c+=3)l(a.children[c+2],a.children[c]+d+1)}for(let a=0;a<e.length;a+=3)e[a+1]==-1&&l(e[a+2],n[a]+s+1);return t}function lt(e,n,t){if(n.isLeaf)return null;let o=t+n.nodeSize,i=null;for(let s=0,r;s<e.length;s++)(r=e[s])&&r.from>t&&r.to<o&&((i||(i=[])).push(r),e[s]=null);return i}function at(e){let n=[];for(let t=0;t<e.length;t++)e[t]!=null&&n.push(e[t]);return n}function w(e,n,t,o){let i=[],s=!1;n.forEach((l,a)=>{let d=lt(e,l,a+t);if(d){s=!0;let c=w(d,l,t+a+1,o);c!=g&&i.push(a,a+l.nodeSize,c)}});let r=rt(s?at(e):e,-t).sort(B);for(let l=0;l<r.length;l++)r[l].type.valid(n,r[l])||(o.onRemove&&o.onRemove(r[l].spec),r.splice(l--,1));return r.length||i.length?new C(r,i):g}function B(e,n){return e.from-n.from||e.to-n.to}function Ne(e){let n=e;for(let t=0;t<n.length-1;t++){let o=n[t];if(o.from!=o.to)for(let i=t+1;i<n.length;i++){let s=n[i];if(s.from==o.from){s.to!=o.to&&(n==e&&(n=e.slice()),n[i]=s.copy(s.from,o.to),Ke(n,i+1,s.copy(o.to,s.to)));continue}else{s.from<o.to&&(n==e&&(n=e.slice()),n[t]=o.copy(o.from,s.from),Ke(n,i,o.copy(s.from,o.to)));break}}}return n}function Ke(e,n,t){for(;n<e.length&&B(t,e[n])>0;)n++;e.splice(n,0,t)}var Qt=H&&me<=11;export{q as a,C as b};
//# sourceMappingURL=chunk-ZV6GEKUM.js.map
