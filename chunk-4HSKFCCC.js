import{f as g}from"./chunk-DZ52HI7M.js";import{a as T,c as h}from"./chunk-76UFDRTB.js";import"./chunk-4L5325VZ.js";import{E as p,_a as m}from"./chunk-A2TAJ4Q2.js";var H=m.create({name:"details",addOptions(){return{HTMLAttributes:{}}},addAttributes(){return{opened:{default:!0,keepOnSplit:!1,parseHTML:t=>t.getAttribute("data-opened")==="true",renderHTML:t=>({"data-opened":t.opened})}}},content:"summary detailsContent",group:"block",draggable:!0,allowGapCursor:!0,isolating:!0,parseHTML(){return[{tag:"details"}]},renderHTML({HTMLAttributes:t}){return["div",{class:"t-details-wrapper t-details-wrapper_rendered"},["details",p(this.options.HTMLAttributes,t),0],["button",{class:"t-details-arrow"}]]},addNodeView(){return({node:t,getPos:r})=>{if(globalThis.document){let a=document.createElement("div"),e=document.createElement("details"),n=document.createElement("button"),o=document.createElement("button");a.className="t-details-wrapper",n.className="t-details-arrow",n.type="button",o.className="t-details-delete",o.type="button",e.open=t.attrs.opened;let l=u=>{var i,s,d;let c=(s=(i=r)===null||i===void 0?void 0:i())!==null&&s!==void 0?s:0;e.open=!e.open,t.attrs.opened=e.open,(d=u.target)===null||d===void 0||d.dispatchEvent(new CustomEvent(g,{bubbles:!0})),this.editor.chain().focus().setTextSelection(c).run()};return n.addEventListener("click",l),o.addEventListener("click",u=>{var i,s,d,c;n.removeEventListener("click",l);let b=(s=(i=r)===null||i===void 0?void 0:i())!==null&&s!==void 0?s:0;this.editor.chain().focus().setTextSelection((d=r)===null||d===void 0?void 0:d()).run();let v=this.editor.state.selection.$anchor.nodeAfter,f=b+((c=v==null?void 0:v.nodeSize)!==null&&c!==void 0?c:0);this.editor.isActive("summary")?this.editor.commands.deleteNode(this.type):this.editor.commands.deleteRange({from:b,to:f}),u.preventDefault()},{capture:!0,once:!0}),a.append(e,n,o),{dom:a,contentDOM:e}}}},addCommands(){return{setDetails:()=>({commands:t,editor:r,state:a})=>{var e,n,o;let l="",u=this.editor.state.selection.$anchor.pos;return globalThis.document&&(l=((o=(n=(e=document.defaultView)===null||e===void 0?void 0:e.window.getSelection())===null||n===void 0?void 0:n.toString().trim().length)!==null&&o!==void 0?o:0)>0?h(a):"",setTimeout(()=>r.chain().focus().setTextSelection(u).run())),t.insertContent(`<details data-opened="true"><summary><p></p></summary><div data-type="details-content"><p>${l}</p></div></details><p></p>`)},removeDetails:()=>({editor:t,state:r,dispatch:a})=>(T(r,a,this.name),t.commands.focus("end"))}}}),M=m.create({name:"detailsContent",content:"block+",group:"block",allowGapCursor:!0,parseHTML(){return[{tag:'div[data-type="details-content"]'}]},renderHTML({HTMLAttributes:t}){return["div",p(this.options.HTMLAttributes,t,{"data-type":"details-content"}),0]}}),_=m.create({name:"summary",addOptions(){return{HTMLAttributes:{}}},content:"paragraph",group:"block",parseHTML(){return[{tag:"summary"}]},renderHTML({HTMLAttributes:t}){return["summary",p(this.options.HTMLAttributes,t),0]}});export{H as TuiDetails,M as TuiDetailsContent,_ as TuiSummary};
//# sourceMappingURL=chunk-4HSKFCCC.js.map
