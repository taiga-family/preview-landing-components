import{f as g}from"./chunk-DZ52HI7M.js";import{a as T,c as h}from"./chunk-GI2A5XT4.js";import"./chunk-DQQKXDMC.js";import{E as p,_a as m}from"./chunk-O35IZNJS.js";var _=m.create({name:"details",addOptions(){return{HTMLAttributes:{}}},addAttributes(){return{opened:{default:!0,keepOnSplit:!1,parseHTML:e=>e.getAttribute("data-opened")==="true",renderHTML:e=>({"data-opened":e.opened})}}},content:"summary detailsContent",group:"block",draggable:!0,allowGapCursor:!0,isolating:!0,parseHTML(){return[{tag:"details"}]},renderHTML({HTMLAttributes:e}){let n=p(this.options.HTMLAttributes,Object.assign(Object.assign({},e),{open:e["data-opened"]||void 0}));return["div",{class:"t-details-wrapper t-details-wrapper_rendered"},["details",n,0],["button",{class:"t-details-arrow"}]]},addNodeView(){return({node:e,getPos:n})=>{if(globalThis.document){let a=document.createElement("div"),t=document.createElement("details"),o=document.createElement("button"),r=document.createElement("button");a.className="t-details-wrapper",o.className="t-details-arrow",o.type="button",r.className="t-details-delete",r.type="button",t.open=e.attrs.opened;let l=u=>{var i,s,d;let c=(s=(i=n)===null||i===void 0?void 0:i())!==null&&s!==void 0?s:0;t.open=!t.open,e.attrs.opened=t.open,(d=u.target)===null||d===void 0||d.dispatchEvent(new CustomEvent(g,{bubbles:!0})),this.editor.chain().focus().setTextSelection(c).run()};return o.addEventListener("click",l),r.addEventListener("click",u=>{var i,s,d,c;o.removeEventListener("click",l);let b=(s=(i=n)===null||i===void 0?void 0:i())!==null&&s!==void 0?s:0;this.editor.chain().focus().setTextSelection((d=n)===null||d===void 0?void 0:d()).run();let v=this.editor.state.selection.$anchor.nodeAfter,f=b+((c=v==null?void 0:v.nodeSize)!==null&&c!==void 0?c:0);this.editor.isActive("summary")?this.editor.commands.deleteNode(this.type):this.editor.commands.deleteRange({from:b,to:f}),u.preventDefault()},{capture:!0,once:!0}),a.append(t,o,r),{dom:a,contentDOM:t}}}},addCommands(){return{setDetails:()=>({commands:e,editor:n,state:a})=>{var t,o,r;let l="",u=this.editor.state.selection.$anchor.pos;return globalThis.document&&(l=((r=(o=(t=document.defaultView)===null||t===void 0?void 0:t.window.getSelection())===null||o===void 0?void 0:o.toString().trim().length)!==null&&r!==void 0?r:0)>0?h(a):"",setTimeout(()=>n.chain().focus().setTextSelection(u).run())),e.insertContent(`<details data-opened="true"><summary><p></p></summary><div data-type="details-content"><p>${l}</p></div></details><p></p>`)},removeDetails:()=>({editor:e,state:n,dispatch:a})=>(T(n,a,this.name),e.commands.focus("end"))}}}),w=m.create({name:"detailsContent",content:"block+",group:"block",allowGapCursor:!0,parseHTML(){return[{tag:'div[data-type="details-content"]'}]},renderHTML({HTMLAttributes:e}){return["div",p(this.options.HTMLAttributes,e,{"data-type":"details-content"}),0]}}),H=m.create({name:"summary",addOptions(){return{HTMLAttributes:{}}},content:"paragraph",group:"block",parseHTML(){return[{tag:"summary"}]},renderHTML({HTMLAttributes:e}){return["summary",p(this.options.HTMLAttributes,e),0]}});export{_ as TuiDetails,w as TuiDetailsContent,H as TuiSummary};
//# sourceMappingURL=chunk-FA4MZANG.js.map
