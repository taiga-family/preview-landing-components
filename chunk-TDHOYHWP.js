import{B as u,E as ne,Ra as y,Sa as ie,Ta as N,V as I,Va as k,Wa as b,Xa as h,Za as M,a as H,b as O,c as U,g as $,ga as se,h as V,i as X,j as Z,l as E,la as B,n as A,o as R,q as x,r as P,s as Q,t as ee,u as te,x as re}from"./chunk-GOOAHOWT.js";var _e=/^\s*>\s$/,oe=h.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",u(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[k({find:_e,type:this.type})]}});var Ke=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,$e=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,Ve=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,ze=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,ae=b.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",u(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[y({find:Ke,type:this.type}),y({find:Ve,type:this.type})]},addPasteRules(){return[M({find:$e,type:this.type}),M({find:ze,type:this.type})]}});var je=h.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",u(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),le=b.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:t=>t.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["span",u(this.options.HTMLAttributes,t),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:t,commands:e})=>{let r=B(t,this.type);return Object.entries(r).some(([,n])=>!!n)?!0:e.unsetMark(this.name)}}}}),de=/^\s*([-+*])\s$/,ue=h.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",u(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(je.name,this.editor.getAttributes(le.name)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=k({find:de,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=k({find:de,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(le.name),editor:this.editor})),[t]}});var Ge=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,Fe=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,pe=b.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",u(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[y({find:Ge,type:this.type})]},addPasteRules(){return[M({find:Fe,type:this.type})]}});var We=/^```([a-z]+)?[\s\n]$/,qe=/^~~~([a-z]+)?[\s\n]$/,ce=h.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:t=>{var e;let{languageClassPrefix:r}=this.options,i=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(r)).map(o=>o.replace(r,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",u(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{let{empty:t,$anchor:e}=this.editor.state.selection,r=e.pos===1;return!t||e.parent.type.name!==this.name?!1:r||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;let{state:e}=t,{selection:r}=e,{$from:s,empty:n}=r;if(!n||s.parent.type!==this.type)return!1;let i=s.parentOffset===s.parent.nodeSize-2,o=s.parent.textContent.endsWith(`

`);return!i||!o?!1:t.chain().command(({tr:a})=>(a.delete(s.pos-2,s.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;let{state:e}=t,{selection:r,doc:s}=e,{$from:n,empty:i}=r;if(!i||n.parent.type!==this.type||!(n.parentOffset===n.parent.nodeSize-2))return!1;let a=n.after();return a===void 0||s.nodeAt(a)?!1:t.commands.exitCode()}}},addInputRules(){return[N({find:We,type:this.type,getAttributes:t=>({language:t[1]})}),N({find:qe,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new x({key:new P("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;let r=e.clipboardData.getData("text/plain"),s=e.clipboardData.getData("vscode-editor-data"),n=s?JSON.parse(s):void 0,i=n==null?void 0:n.mode;if(!r||!i)return!1;let{tr:o}=t.state;return o.replaceSelectionWith(this.type.create({language:i})),o.setSelection(A.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.insertText(r.replace(/\r\n?/g,`
`)),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}});var he=h.create({name:"doc",topNode:!0,content:"block+"});function fe(t={}){return new x({view(e){return new z(e,t)}})}var z=class{constructor(e,r){var s;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(s=r.width)!==null&&s!==void 0?s:1,this.color=r.color===!1?void 0:r.color||"black",this.class=r.class,this.handlers=["dragover","dragend","drop","dragleave"].map(n=>{let i=o=>{this[n](o)};return e.dom.addEventListener(n,i),{name:n,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:r})=>this.editorView.dom.removeEventListener(e,r))}update(e,r){this.cursorPos!=null&&r.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),r=!e.parent.inlineContent,s;if(r){let a=e.nodeBefore,l=e.nodeAfter;if(a||l){let d=this.editorView.nodeDOM(this.cursorPos-(a?a.nodeSize:0));if(d){let p=d.getBoundingClientRect(),c=a?p.bottom:p.top;a&&l&&(c=(c+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),s={left:p.left,right:p.right,top:c-this.width/2,bottom:c+this.width/2}}}}if(!s){let a=this.editorView.coordsAtPos(this.cursorPos);s={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}let n=this.editorView.dom.offsetParent;this.element||(this.element=n.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r);let i,o;if(!n||n==document.body&&getComputedStyle(n).position=="static")i=-pageXOffset,o=-pageYOffset;else{let a=n.getBoundingClientRect();i=a.left-n.scrollLeft,o=a.top-n.scrollTop}this.element.style.left=s.left-i+"px",this.element.style.top=s.top-o+"px",this.element.style.width=s.right-s.left+"px",this.element.style.height=s.bottom-s.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let r=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),s=r&&r.inside>=0&&this.editorView.state.doc.nodeAt(r.inside),n=s&&s.type.spec.disableDropCursor,i=typeof n=="function"?n(this.editorView,r,e):n;if(r&&!i){let o=r.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=Z(this.editorView.state.doc,o,this.editorView.dragging.slice);a!=null&&(o=a)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}};var me=I.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[fe(this.options)]}});var v=class t extends E{constructor(e){super(e,e)}map(e,r){let s=e.resolve(r.map(this.head));return t.valid(s)?new t(s):E.near(s)}content(){return V.empty}eq(e){return e instanceof t&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new t(e.resolve(r.pos))}getBookmark(){return new j(this.anchor)}static valid(e){let r=e.parent;if(r.isTextblock||!Je(e)||!Ye(e))return!1;let s=r.type.spec.allowGapCursor;if(s!=null)return s;let n=r.contentMatchAt(e.index()).defaultType;return n&&n.isTextblock}static findGapCursorFrom(e,r,s=!1){e:for(;;){if(!s&&t.valid(e))return e;let n=e.pos,i=null;for(let o=e.depth;;o--){let a=e.node(o);if(r>0?e.indexAfter(o)<a.childCount:e.index(o)>0){i=a.child(r>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;n+=r;let l=e.doc.resolve(n);if(t.valid(l))return l}for(;;){let o=r>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!R.isSelectable(i)){e=e.doc.resolve(n+i.nodeSize*r),s=!1;continue e}break}i=o,n+=r;let a=e.doc.resolve(n);if(t.valid(a))return a}return null}}};v.prototype.visible=!1;v.findFrom=v.findGapCursorFrom;E.jsonID("gapcursor",v);var j=class t{constructor(e){this.pos=e}map(e){return new t(e.map(this.pos))}resolve(e){let r=e.resolve(this.pos);return v.valid(r)?new v(r):E.near(r)}};function Je(t){for(let e=t.depth;e>=0;e--){let r=t.index(e),s=t.node(e);if(r==0){if(s.type.spec.isolating)return!0;continue}for(let n=s.child(r-1);;n=n.lastChild){if(n.childCount==0&&!n.inlineContent||n.isAtom||n.type.spec.isolating)return!0;if(n.inlineContent)return!1}}return!0}function Ye(t){for(let e=t.depth;e>=0;e--){let r=t.indexAfter(e),s=t.node(e);if(r==s.childCount){if(s.type.spec.isolating)return!0;continue}for(let n=s.child(r);;n=n.firstChild){if(n.childCount==0&&!n.inlineContent||n.isAtom||n.type.spec.isolating)return!0;if(n.inlineContent)return!1}}return!0}function ge(){return new x({props:{decorations:Qe,createSelectionBetween(t,e,r){return e.pos==r.pos&&v.valid(r)?new v(r):null},handleClick:Xe,handleKeyDown:Ue,handleDOMEvents:{beforeinput:Ze}}})}var Ue=te({ArrowLeft:D("horiz",-1),ArrowRight:D("horiz",1),ArrowUp:D("vert",-1),ArrowDown:D("vert",1)});function D(t,e){let r=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(s,n,i){let o=s.selection,a=e>0?o.$to:o.$from,l=o.empty;if(o instanceof A){if(!i.endOfTextblock(r)||a.depth==0)return!1;l=!1,a=s.doc.resolve(e>0?a.after():a.before())}let d=v.findGapCursorFrom(a,e,l);return d?(n&&n(s.tr.setSelection(new v(d))),!0):!1}}function Xe(t,e,r){if(!t||!t.editable)return!1;let s=t.state.doc.resolve(e);if(!v.valid(s))return!1;let n=t.posAtCoords({left:r.clientX,top:r.clientY});return n&&n.inside>-1&&R.isSelectable(t.state.doc.nodeAt(n.inside))?!1:(t.dispatch(t.state.tr.setSelection(new v(s))),!0)}function Ze(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof v))return!1;let{$from:r}=t.state.selection,s=r.parent.contentMatchAt(r.index()).findWrapping(t.state.schema.nodes.text);if(!s)return!1;let n=$.empty;for(let o=s.length-1;o>=0;o--)n=$.from(s[o].createAndFill(null,n));let i=t.state.tr.replace(r.pos,r.pos,new V(n,0,0));return i.setSelection(A.near(i.doc.resolve(r.pos+1))),t.dispatch(i),!1}function Qe(t){if(!(t.selection instanceof v))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",ee.create(t.doc,[Q.widget(t.selection.head,e,{key:"gapcursor"})])}var ve=I.create({name:"gapCursor",addProseMirrorPlugins(){return[ge()]},extendNodeSchema(t){var e;let r={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=ne(re(t,"allowGapCursor",r)))!==null&&e!==void 0?e:null}}});var be=h.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",u(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:r,editor:s})=>t.first([()=>t.exitCode(),()=>t.command(()=>{let{selection:n,storedMarks:i}=r;if(n.$from.parent.type.spec.isolating)return!1;let{keepMarks:o}=this.options,{splittableMarks:a}=s.extensionManager,l=i||n.$to.parentOffset&&n.$from.marks();return e().insertContent({type:this.name}).command(({tr:d,dispatch:p})=>{if(p&&l&&o){let c=l.filter(f=>a.includes(f.type.name));d.ensureMarks(c)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}});var ye=h.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,u(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>O(H({},t),{[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>N({find:new RegExp(`^(#{1,${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var _=200,g=function(){};g.prototype.append=function(e){return e.length?(e=g.from(e),!this.length&&e||e.length<_&&this.leafAppend(e)||this.length<_&&e.leafPrepend(this)||this.appendInner(e)):this};g.prototype.prepend=function(e){return e.length?g.from(e).append(this):this};g.prototype.appendInner=function(e){return new et(this,e)};g.prototype.slice=function(e,r){return e===void 0&&(e=0),r===void 0&&(r=this.length),e>=r?g.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,r))};g.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};g.prototype.forEach=function(e,r,s){r===void 0&&(r=0),s===void 0&&(s=this.length),r<=s?this.forEachInner(e,r,s,0):this.forEachInvertedInner(e,r,s,0)};g.prototype.map=function(e,r,s){r===void 0&&(r=0),s===void 0&&(s=this.length);var n=[];return this.forEach(function(i,o){return n.push(e(i,o))},r,s),n};g.from=function(e){return e instanceof g?e:e&&e.length?new ke(e):g.empty};var ke=function(t){function e(s){t.call(this),this.values=s}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(n,i){return n==0&&i==this.length?this:new e(this.values.slice(n,i))},e.prototype.getInner=function(n){return this.values[n]},e.prototype.forEachInner=function(n,i,o,a){for(var l=i;l<o;l++)if(n(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(n,i,o,a){for(var l=i-1;l>=o;l--)if(n(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(n){if(this.length+n.length<=_)return new e(this.values.concat(n.flatten()))},e.prototype.leafPrepend=function(n){if(this.length+n.length<=_)return new e(n.flatten().concat(this.values))},r.length.get=function(){return this.values.length},r.depth.get=function(){return 0},Object.defineProperties(e.prototype,r),e}(g);g.empty=new ke([]);var et=function(t){function e(r,s){t.call(this),this.left=r,this.right=s,this.length=r.length+s.length,this.depth=Math.max(r.depth,s.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(s){return s<this.left.length?this.left.get(s):this.right.get(s-this.left.length)},e.prototype.forEachInner=function(s,n,i,o){var a=this.left.length;if(n<a&&this.left.forEachInner(s,n,Math.min(i,a),o)===!1||i>a&&this.right.forEachInner(s,Math.max(n-a,0),Math.min(this.length,i)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(s,n,i,o){var a=this.left.length;if(n>a&&this.right.forEachInvertedInner(s,n-a,Math.max(i,a)-a,o+a)===!1||i<a&&this.left.forEachInvertedInner(s,Math.min(n,a),i,o)===!1)return!1},e.prototype.sliceInner=function(s,n){if(s==0&&n==this.length)return this;var i=this.left.length;return n<=i?this.left.slice(s,n):s>=i?this.right.slice(s-i,n-i):this.left.slice(s,i).append(this.right.slice(0,n-i))},e.prototype.leafAppend=function(s){var n=this.right.leafAppend(s);if(n)return new e(this.left,n)},e.prototype.leafPrepend=function(s){var n=this.left.leafPrepend(s);if(n)return new e(n,this.right)},e.prototype.appendInner=function(s){return this.left.depth>=Math.max(this.right.depth,s.depth)+1?new e(this.left,new e(this.right,s)):new e(this,s)},e}(g),G=g;var tt=500,S=class t{constructor(e,r){this.items=e,this.eventCount=r}popEvent(e,r){if(this.eventCount==0)return null;let s=this.items.length;for(;;s--)if(this.items.get(s-1).selection){--s;break}let n,i;r&&(n=this.remapping(s,this.items.length),i=n.maps.length);let o=e.tr,a,l,d=[],p=[];return this.items.forEach((c,f)=>{if(!c.step){n||(n=this.remapping(s,f+1),i=n.maps.length),i--,p.push(c);return}if(n){p.push(new T(c.map));let m=c.step.map(n.slice(i)),w;m&&o.maybeStep(m).doc&&(w=o.mapping.maps[o.mapping.maps.length-1],d.push(new T(w,void 0,void 0,d.length+p.length))),i--,w&&n.appendMap(w,i)}else o.maybeStep(c.step);if(c.selection)return a=n?c.selection.map(n.slice(i)):c.selection,l=new t(this.items.slice(0,s).append(p.reverse().concat(d)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,r,s,n){let i=[],o=this.eventCount,a=this.items,l=!n&&a.length?a.get(a.length-1):null;for(let p=0;p<e.steps.length;p++){let c=e.steps[p].invert(e.docs[p]),f=new T(e.mapping.maps[p],c,r),m;(m=l&&l.merge(f))&&(f=m,p?i.pop():a=a.slice(0,a.length-1)),i.push(f),r&&(o++,r=void 0),n||(l=f)}let d=o-s.depth;return d>nt&&(a=rt(a,d),o-=d),new t(a.append(i),o)}remapping(e,r){let s=new X;return this.items.forEach((n,i)=>{let o=n.mirrorOffset!=null&&i-n.mirrorOffset>=e?s.maps.length-n.mirrorOffset:void 0;s.appendMap(n.map,o)},e,r),s}addMaps(e){return this.eventCount==0?this:new t(this.items.append(e.map(r=>new T(r))),this.eventCount)}rebased(e,r){if(!this.eventCount)return this;let s=[],n=Math.max(0,this.items.length-r),i=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(f=>{f.selection&&a--},n);let l=r;this.items.forEach(f=>{let m=i.getMirror(--l);if(m==null)return;o=Math.min(o,m);let w=i.maps[m];if(f.step){let De=e.steps[m].invert(e.docs[m]),Y=f.selection&&f.selection.map(i.slice(l+1,m));Y&&a++,s.push(new T(w,De,Y))}else s.push(new T(w))},n);let d=[];for(let f=r;f<o;f++)d.push(new T(i.maps[f]));let p=this.items.slice(0,n).append(d).append(s),c=new t(p,a);return c.emptyItemCount()>tt&&(c=c.compress(this.items.length-s.length)),c}emptyItemCount(){let e=0;return this.items.forEach(r=>{r.step||e++}),e}compress(e=this.items.length){let r=this.remapping(0,e),s=r.maps.length,n=[],i=0;return this.items.forEach((o,a)=>{if(a>=e)n.push(o),o.selection&&i++;else if(o.step){let l=o.step.map(r.slice(s)),d=l&&l.getMap();if(s--,d&&r.appendMap(d,s),l){let p=o.selection&&o.selection.map(r.slice(s));p&&i++;let c=new T(d.invert(),l,p),f,m=n.length-1;(f=n.length&&n[m].merge(c))?n[m]=f:n.push(c)}}else o.map&&s--},this.items.length,0),new t(G.from(n.reverse()),i)}};S.empty=new S(G.empty,0);function rt(t,e){let r;return t.forEach((s,n)=>{if(s.selection&&e--==0)return r=n,!1}),t.slice(r)}var T=class t{constructor(e,r,s,n){this.map=e,this.step=r,this.selection=s,this.mirrorOffset=n}merge(e){if(this.step&&e.step&&!e.selection){let r=e.step.merge(this.step);if(r)return new t(r.getMap().invert(),r,this.selection)}}},L=class{constructor(e,r,s,n,i){this.done=e,this.undone=r,this.prevRanges=s,this.prevTime=n,this.prevComposition=i}},nt=20;function st(t,e,r,s){let n=r.getMeta(C),i;if(n)return n.historyState;r.getMeta(ot)&&(t=new L(t.done,t.undone,null,0,-1));let o=r.getMeta("appendedTransaction");if(r.steps.length==0)return t;if(o&&o.getMeta(C))return o.getMeta(C).redo?new L(t.done.addTransform(r,void 0,s,K(e)),t.undone,Me(r.mapping.maps[r.steps.length-1]),t.prevTime,t.prevComposition):new L(t.done,t.undone.addTransform(r,void 0,s,K(e)),null,t.prevTime,t.prevComposition);if(r.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=r.getMeta("composition"),l=t.prevTime==0||!o&&t.prevComposition!=a&&(t.prevTime<(r.time||0)-s.newGroupDelay||!it(r,t.prevRanges)),d=o?F(t.prevRanges,r.mapping):Me(r.mapping.maps[r.steps.length-1]);return new L(t.done.addTransform(r,l?e.selection.getBookmark():void 0,s,K(e)),S.empty,d,r.time,a??t.prevComposition)}else return(i=r.getMeta("rebased"))?new L(t.done.rebased(r,i),t.undone.rebased(r,i),F(t.prevRanges,r.mapping),t.prevTime,t.prevComposition):new L(t.done.addMaps(r.mapping.maps),t.undone.addMaps(r.mapping.maps),F(t.prevRanges,r.mapping),t.prevTime,t.prevComposition)}function it(t,e){if(!e)return!1;if(!t.docChanged)return!0;let r=!1;return t.mapping.maps[0].forEach((s,n)=>{for(let i=0;i<e.length;i+=2)s<=e[i+1]&&n>=e[i]&&(r=!0)}),r}function Me(t){let e=[];return t.forEach((r,s,n,i)=>e.push(n,i)),e}function F(t,e){if(!t)return null;let r=[];for(let s=0;s<t.length;s+=2){let n=e.map(t[s],1),i=e.map(t[s+1],-1);n<=i&&r.push(n,i)}return r}function Le(t,e,r,s){let n=K(e),i=C.get(e).spec.config,o=(s?t.undone:t.done).popEvent(e,n);if(!o)return;let a=o.selection.resolve(o.transform.doc),l=(s?t.done:t.undone).addTransform(o.transform,e.selection.getBookmark(),i,n),d=new L(s?l:o.remaining,s?o.remaining:l,null,0,-1);r(o.transform.setSelection(a).setMeta(C,{redo:s,historyState:d}).scrollIntoView())}var W=!1,Te=null;function K(t){let e=t.plugins;if(Te!=e){W=!1,Te=e;for(let r=0;r<e.length;r++)if(e[r].spec.historyPreserveItems){W=!0;break}}return W}var C=new P("history"),ot=new P("closeHistory");function Ae(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new x({key:C,state:{init(){return new L(S.empty,S.empty,null,0,-1)},apply(e,r,s){return st(r,s,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,r){let s=r.inputType,n=s=="historyUndo"?q:s=="historyRedo"?J:null;return n?(r.preventDefault(),n(e.state,e.dispatch)):!1}}}})}var q=(t,e)=>{let r=C.getState(t);return!r||r.done.eventCount==0?!1:(e&&Le(r,t,e,!1),!0)},J=(t,e)=>{let r=C.getState(t);return!r||r.undone.eventCount==0?!1:(e&&Le(r,t,e,!0),!0)};var xe=I.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>q(t,e),redo:()=>({state:t,dispatch:e})=>J(t,e)}},addProseMirrorPlugins(){return[Ae(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-Z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-Y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Shift-Mod-Z":()=>this.editor.commands.redo(),"Mod-\u044F":()=>this.editor.commands.undo(),"Shift-Mod-\u044F":()=>this.editor.commands.redo()}}});var Ie=h.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",u(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{let{$to:r}=e.selection,s=t();return r.parentOffset===0?s.insertContentAt(Math.max(r.pos-2,0),{type:this.name}):s.insertContent({type:this.name}),s.command(({tr:n,dispatch:i})=>{var o;if(i){let{$to:a}=n.selection,l=a.end();if(a.nodeAfter)a.nodeAfter.isTextblock?n.setSelection(A.create(n.doc,a.pos+1)):a.nodeAfter.isBlock?n.setSelection(R.create(n.doc,a.pos)):n.setSelection(A.create(n.doc,a.pos));else{let d=(o=a.parent.type.contentMatch.defaultType)===null||o===void 0?void 0:o.create();d&&(n.insert(l,d),n.setSelection(A.create(n.doc,l+1)))}n.scrollIntoView()}return!0}).run()}}},addInputRules(){return[ie({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}});var at=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,lt=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,dt=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,ut=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,Ce=b.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",u(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[y({find:at,type:this.type}),y({find:dt,type:this.type})]},addPasteRules(){return[M({find:lt,type:this.type}),M({find:ut,type:this.type})]}});var we=h.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",u(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}});var pt=h.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",u(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),He=b.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:t=>t.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["span",u(this.options.HTMLAttributes,t),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:t,commands:e})=>{let r=B(t,this.type);return Object.entries(r).some(([,n])=>!!n)?!0:e.unsetMark(this.name)}}}}),Se=/^(\d+)\.\s$/,Oe=h.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){let s=t,{start:e}=s,r=U(s,["start"]);return e===1?["ol",u(this.options.HTMLAttributes,r),0]:["ol",u(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(pt.name,this.editor.getAttributes(He.name)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=k({find:Se,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,r)=>r.childCount+r.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=k({find:Se,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>H({start:+e[1]},this.editor.getAttributes(He.name)),joinPredicate:(e,r)=>r.childCount+r.attrs.start===+e[1],editor:this.editor})),[t]}});var Ee=h.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",u(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}});var ct=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,ht=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,Re=b.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",u(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){let t={};return se()?t["Mod-Shift-s"]=()=>this.editor.commands.toggleStrike():t["Ctrl-Shift-s"]=()=>this.editor.commands.toggleStrike(),t},addInputRules(){return[y({find:ct,type:this.type})]},addPasteRules(){return[M({find:ht,type:this.type})]}});var ft=/^\s*(\[([( |x])?\])\s$/,Pe=h.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList"}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>t.getAttribute("data-checked")==="true",renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",u(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts(){let t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?O(H({},t),{Tab:()=>this.editor.commands.sinkListItem(this.name)}):t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:r,editor:s})=>{let n=document.createElement("li"),i=document.createElement("label"),o=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div");return i.contentEditable="false",a.type="checkbox",a.addEventListener("change",d=>{if(!s.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}let{checked:p}=d.target;s.isEditable&&typeof r=="function"&&s.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:c})=>{let f=r(),m=c.doc.nodeAt(f);return c.setNodeMarkup(f,void 0,O(H({},m==null?void 0:m.attrs),{checked:p})),!0}).run(),!s.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,p)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([d,p])=>{n.setAttribute(d,p)}),n.dataset.checked=t.attrs.checked,t.attrs.checked&&a.setAttribute("checked","checked"),i.append(a,o),n.append(i,l),Object.entries(e).forEach(([d,p])=>{n.setAttribute(d,p)}),{dom:n,contentDOM:l,update:d=>d.type!==this.type?!1:(n.dataset.checked=d.attrs.checked,d.attrs.checked?a.setAttribute("checked","checked"):a.removeAttribute("checked"),!0)}}},addInputRules(){return[k({find:ft,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}});var Ne=h.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",u(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});var Be=h.create({name:"text",group:"inline"});var Yr=I.create({name:"starterKit",addExtensions(){let t=[],e=this.options;return(e==null?void 0:e.blockquote)!==!1&&t.push(oe.configure(e==null?void 0:e.blockquote)),(e==null?void 0:e.bold)!==!1&&t.push(ae.configure(e==null?void 0:e.bold)),(e==null?void 0:e.bulletList)!==!1&&t.push(ue.configure(e==null?void 0:e.bulletList)),(e==null?void 0:e.code)!==!1&&t.push(pe.configure(e==null?void 0:e.code)),(e==null?void 0:e.codeBlock)!==!1&&t.push(ce.configure(e==null?void 0:e.codeBlock)),(e==null?void 0:e.document)!==!1&&t.push(he.configure(e==null?void 0:e.document)),(e==null?void 0:e.dropcursor)!==!1&&t.push(me.configure(e==null?void 0:e.dropcursor)),(e==null?void 0:e.gapcursor)!==!1&&t.push(ve.configure(e==null?void 0:e.gapcursor)),(e==null?void 0:e.hardBreak)!==!1&&t.push(be.configure(e==null?void 0:e.hardBreak)),(e==null?void 0:e.heading)!==!1&&t.push(ye.configure(Object.assign({levels:[1,2,3,4,5,6]},e==null?void 0:e.heading)).extend({addKeyboardShortcuts(){return this.options.levels.reduce((r,s)=>Object.assign(Object.assign({},r||{}),{[`Mod-Alt-${s}`]:()=>this===null||this===void 0?void 0:this.editor.commands.toggleHeading({level:s})}),{})}})),(e==null?void 0:e.history)!==!1&&t.push(xe.configure(Object.assign({depth:100,newGroupDelay:500},e==null?void 0:e.history))),(e==null?void 0:e.horizontalRule)!==!1&&t.push(Ie.configure(e==null?void 0:e.horizontalRule)),(e==null?void 0:e.italic)!==!1&&t.push(Ce.configure(e==null?void 0:e.italic)),(e==null?void 0:e.listItem)!==!1&&t.push(we.configure(e==null?void 0:e.listItem)),(e==null?void 0:e.taskList)!==!1&&t.push(Ne.configure(e==null?void 0:e.taskList)),(e==null?void 0:e.taskItem)!==!1&&t.push(Pe.configure(Object.assign({nested:!0},e==null?void 0:e.taskItem))),(e==null?void 0:e.orderedList)!==!1&&t.push(Oe.configure(e==null?void 0:e.orderedList)),(e==null?void 0:e.paragraph)!==!1&&t.push(Ee.configure(e==null?void 0:e.paragraph)),(e==null?void 0:e.strike)!==!1&&t.push(Re.configure(e==null?void 0:e.strike)),(e==null?void 0:e.text)!==!1&&t.push(Be.configure(e==null?void 0:e.text)),t}});export{Yr as StarterKit};
//# sourceMappingURL=chunk-TDHOYHWP.js.map
